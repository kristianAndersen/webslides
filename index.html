<!-- Sender HTML file (sender.html or index.html) -->
<!DOCTYPE html>
<html>
<head>
    <title>Chrome Cast Sender with Display Info</title>
    <script type="text/javascript" src="https://www.gstatic.com/cv/js/sender/v1/cast_sender.js?loadCastFramework=1"></script>
</head>
<body>
    <h1>Chrome Cast Sender</h1>
    <button id="castButton">Start Casting</button>
    <div id="displayInfo"></div>

    <script>
        let session;

        window['__onGCastApiAvailable'] = function(isAvailable) {
            if (isAvailable) {
                initializeCastApi();
            }
        };

        function initializeCastApi() {
            const castContext = cast.framework.CastContext.getInstance();
            castContext.setOptions({
                receiverApplicationId: chrome.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID,
                autoJoinPolicy: chrome.cast.AutoJoinPolicy.ORIGIN_SCOPED
            });

            const castButton = document.getElementById('castButton');
            castButton.addEventListener('click', () => {
                if (session) {
                    session.leave();
                } else {
                    castContext.requestSession().then(
                        function(s) {
                            session = s;
                            session.addMessageListener('urn:x-cast:com.example.castmessage', function(namespace, message) {
                                const displayInfo = JSON.parse(message);
                                document.getElementById('displayInfo').innerHTML = `
                                    <p>Width: ${displayInfo.width}px</p>
                                    <p>Height: ${displayInfo.height}px</p>
                                    <p>Aspect Ratio: ${displayInfo.aspectRatio}</p>
                                `;
                            });
                            session.sendMessage('urn:x-cast:com.example.castmessage', 'REQUEST_DISPLAY_INFO');
                        },
                        function(e) {
                            console.error('Error:', e);
                        }
                    );
                }
            });
        }
    </script>
</body>
</html>